% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PriceLeadershipFunctions.R
\name{PriceLeadership-Functions}
\alias{PriceLeadership-Functions}
\alias{ple}
\alias{ple.blp}
\title{Price Leadership Model (PLE) Calibration and Simulation}
\usage{
ple(
  prices,
  shares,
  margins,
  diversions,
  ownerPre,
  ownerPost,
  coalitionPre,
  coalitionPost,
  timingParam = NA_real_,
  normIndex = ifelse(isTRUE(all.equal(sum(shares), 1, check.names = FALSE, tolerance =
    0.001)), 1, NA),
  insideSize = NA_real_,
  output = TRUE,
  mcDelta = rep(0, length(prices)),
  subset = rep(TRUE, length(prices)),
  priceOutside = 0,
  priceStart = prices,
  isMax = FALSE,
  control.slopes,
  control.equ,
  labels = paste("Prod", 1:length(prices), sep = ""),
  ...
)

ple.blp(
  prices,
  shares,
  margins,
  ownerPre,
  ownerPost,
  coalitionPre,
  coalitionPost,
  timingParam = NA_real_,
  normIndex = ifelse(isTRUE(all.equal(sum(shares), 1, check.names = FALSE, tolerance =
    0.001)), 1, NA),
  insideSize = NA_real_,
  output = TRUE,
  mcDelta = rep(0, length(prices)),
  subset = rep(TRUE, length(prices)),
  priceOutside = 0,
  priceStart = prices,
  isMax = FALSE,
  nDraws = 500,
  slopes,
  control.slopes,
  control.equ,
  labels = paste("Prod", 1:length(prices), sep = ""),
  ...
)
}
\arguments{
\item{margins}{A length k vector of product margins. At least one coalition margin
and one fringe margin must be supplied for calibration.}

\item{diversions}{A k x k matrix of diversion ratios with diagonal
elements equal to -1. Default is missing.}

\item{ownerPre}{EITHER a vector of length k whose values
indicate which firm produced a product pre-merger OR
a k x k matrix of pre-merger ownership shares.}

\item{ownerPost}{EITHER a vector of length k whose values
indicate which firm produced a product after the merger OR
a k x k matrix of post-merger ownership shares.}

\item{coalitionPre}{A numeric vector of product indices that are part of the
pre-merger coordinating coalition. Products not in this vector are treated as fringe.
Internally converted to a control matrix.}

\item{coalitionPost}{Required. A numeric vector of product indices in the post-merger
coalition. Products not in this vector are treated as fringe.}

\item{timingParam}{Optional. If provided, firm-specific timing/discount parameters
(delta) are fixed at these values rather than calibrated. Should be a named vector
where names match firm identifiers and values are between 0 and 1. If any IC constraint
binds, all firm-specific timing parameters are estimated and saved.}

\item{normIndex}{An integer equalling the index (position) of the
inside product whose mean valuation will be normalized to 1. Default
is 1, unless \sQuote{shares} sum to less than 1, in which case the default is
NA and an outside good is assumed to exist.}

\item{insideSize}{An integer equal to total pre-merger units sold.
If shares sum to one, this also equals the size of the market.}

\item{output}{a length 1 logical vector equal to TRUE if simulation performed
on output market, FALSE if simulation performed on input market. Default TRUE.}

\item{mcDelta}{A vector of length k where each element equals the
proportional change in a product's marginal costs due to
the merger. Default is 0, which assumes that the merger does not
affect any products' marginal cost.}

\item{subset}{A vector of length k where each element equals TRUE if
the product indexed by that element should be included in the
post-merger simulation and FALSE if it should be excluded. Default is a
length k vector of TRUE.}

\item{priceOutside}{A length 1 vector indicating the price of the
outside good. Default is 0.}

\item{priceStart}{A length k vector of starting values used to solve for
equilibrium price. Default is the \sQuote{prices} vector.}

\item{isMax}{If TRUE, checks to see whether computed price equilibrium
locally maximizes firm profits and returns a warning if not. Default is FALSE.}

\item{control.slopes}{A list of  \code{\link{optim}}
control parameters passed to the calibration routine.}

\item{control.equ}{A list of  \code{\link[BB]{BBsolve}} control parameters
passed to the non-linear equation solver.}

\item{labels}{A k-length vector of labels. Default is "Prod#", where
\sQuote{#} is a number between 1 and the length of \sQuote{prices}.}

\item{...}{Additional options to feed to the optimizer.}
}
\value{
An instance of class \code{\linkS4class{PriceLeadership}} with
calibrated parameters including supermarkup, firm-specific timing parameters 
(if any IC constrained), and slack function values for each coalition firm.
}
\description{
Calibrates consumer demand using Logit and simulates coordinated effects
using the price leadership model of Mansley, Miller, Sheu & Weinberg (2023).
In this framework, a leader firm announces a supermarkup above Bertrand prices,
coalition firms follow the leader, and fringe firms best-respond. The model
tests incentive compatibility constraints and calibrates the timing parameter
from binding constraints.
  between 0 and 1.
}
\details{
Using observed product prices, shares, and margins from both
coalition and fringe firms, \code{ple} calibrates a Logit
demand system and identifies:
\itemize{
  \item The price coefficient (alpha) from fringe firm margins
  \item The supermarkup (m) from coalition firm margins
  \item Firm-specific timing parameters (delta_f) from binding incentive compatibility constraints
}

The price leadership equilibrium is characterized by:
\itemize{
  \item Coalition products priced at p = p_Bertrand + m
  \item Fringe products best-responding to coalition prices
  \item Incentive compatibility: No coalition firm wants to deviate
}

If any coalition IC constraint binds, firm-specific timing parameters are estimated
for all coalition firms. If all constraints are slack (unconstrained equilibrium),
timing parameters cannot be identified from the data.
}
\examples{
\dontrun{
# Beer industry example (MSW 2023)
prices <- c(0.93, 0.88, 1.10, 1.02)
shares <- c(0.35, 0.25, 0.25, 0.15)
margins <- c(0.40, NA, 0.35, 0.25)  # Coalition margins and one fringe margin

result <- ple(
  prices = prices,
  shares = shares,
  margins = margins,
  ownerPre = c("AB", "AB", "MC", "Fringe"),
  ownerPost = c("AB", "AB", "MC", "Fringe"),
  coalitionPre = c(1, 2, 3),  # Products 1-3 in coalition, 4 is fringe
  coalitionPost = c(1, 2, 3),  # Same coalition post-merger
)

summary(result)
result@supermarkupPre   # Pre-merger equilibrium supermarkup
result@supermarkupPost  # Post-merger equilibrium supermarkup
result@timingParam      # Calibrated timing parameter
result@bindingFirm      # Which firm has binding IC
}
}
\references{
Mansley, Miller, Sheu & Weinberg (2023), "A price leadership model
for coordinated effects in merger analysis"
}
\seealso{
\code{\link{logit}} for standard Bertrand pricing

\code{\link{calcProducerSurplusGrimTrigger}} for full cartel Grim Trigger analysis
}
